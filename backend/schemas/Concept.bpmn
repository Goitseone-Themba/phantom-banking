<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" id="Definitions_phantom_banking" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="5.35.0">
  <bpmn:collaboration id="PhantomBankingCollaboration">
    <bpmn:participant id="BusinessOwnerPool" name="Business Owner" processRef="PhantomBankingProcess" />
    <bpmn:participant id="FNBSystemPool" name="FNB System" processRef="FNBSystemProcess" />
    <bpmn:participant id="CustomerPool" name="Customer" processRef="CustomerProcess" />
    <bpmn:participant id="ExternalSystemsPool" name="External Payment Systems" processRef="ExternalSystemsProcess" />
    <bpmn:messageFlow id="MessageFlow_signup" sourceRef="Task_BusinessSignup" targetRef="Task_SetupMerchantAccount" />
    <bpmn:messageFlow id="MessageFlow_wallet_creation" sourceRef="Task_CreateCustomerWallet" targetRef="Task_GenerateVirtualWallet" />
    <bpmn:messageFlow id="MessageFlow_wallet_credentials" sourceRef="Task_GenerateVirtualWallet" targetRef="Task_ReceiveWalletCredentials" />
    <bpmn:messageFlow id="MessageFlow_payment_processing" sourceRef="Task_ProcessTransaction" targetRef="Task_MobileMoneyIntegration" />
  </bpmn:collaboration>
  <bpmn:process id="PhantomBankingProcess" isExecutable="true">
    <bpmn:sequenceFlow id="SequenceFlow_setup_to_portal" sourceRef="Task_SetupMerchantAccount" targetRef="Task_AccessBusinessPortal" />
    <bpmn:sequenceFlow id="SequenceFlow_qr_to_processing" sourceRef="Task_QRPayment" targetRef="Gateway_AccountUpgrade" />
    <bpmn:sequenceFlow id="SequenceFlow_ussd_to_processing" sourceRef="Task_USSDPayment" targetRef="Gateway_AccountUpgrade" />
    <bpmn:sequenceFlow id="SequenceFlow_eft_to_processing" sourceRef="Task_EFTPayment" targetRef="Gateway_AccountUpgrade" />
    <bpmn:sequenceFlow id="SequenceFlow_processing_to_upgrade" sourceRef="Task_ProcessTransaction" targetRef="Gateway_AccountUpgrade" />
    <bpmn:userTask id="Task_BusinessSignup" name="Business Signs Up for Phantom Banking" camunda:assignee="business_owner">
      <bpmn:incoming>SequenceFlow_start_to_signup</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_signup_to_kyc</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:exclusiveGateway id="Gateway_KYCCheck" name="KYC Verification">
      <bpmn:incoming>SequenceFlow_signup_to_kyc</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_kyc_approved</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_kyc_rejected</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:userTask id="Task_AccessBusinessPortal" name="Access Business Portal" camunda:assignee="business_owner">
      <bpmn:incoming>SequenceFlow_setup_to_portal</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_portal_to_wallet_creation</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:userTask id="Task_CreateCustomerWallet" name="Create Customer Wallet" camunda:assignee="business_owner">
      <bpmn:incoming>SequenceFlow_portal_to_wallet_creation</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_wallet_to_payment_method</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:exclusiveGateway id="Gateway_PaymentMethod" name="Select Payment Method">
      <bpmn:incoming>SequenceFlow_wallet_to_payment_method</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_to_qr</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_to_ussd</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_to_eft</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:serviceTask id="Task_QRPayment" name="QR Payment" camunda:type="external" camunda:topic="qr_payment">
      <bpmn:incoming>SequenceFlow_to_qr</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_qr_to_processing</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:serviceTask id="Task_USSDPayment" name="USSD Payment" camunda:type="external" camunda:topic="ussd_payment">
      <bpmn:incoming>SequenceFlow_to_ussd</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_ussd_to_processing</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:serviceTask id="Task_EFTPayment" name="EFT Payment" camunda:type="external" camunda:topic="eft_payment">
      <bpmn:incoming>SequenceFlow_to_eft</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_eft_to_processing</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:endEvent id="EndEvent_ProcessComplete" name="Process Complete">
      <bpmn:incoming>SequenceFlow_upgrade_no</bpmn:incoming>
      <bpmn:incoming>SequenceFlow_kyc_rejected</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:exclusiveGateway id="Gateway_AccountUpgrade" name="Upgrade to Full Account?">
      <bpmn:incoming>SequenceFlow_processing_to_upgrade</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_upgrade_no</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:startEvent id="StartEvent_PhantomBanking" name="Start Phantom Banking Process">
      <bpmn:outgoing>SequenceFlow_start_to_signup</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:sequenceFlow id="SequenceFlow_start_to_signup" sourceRef="StartEvent_PhantomBanking" targetRef="Task_BusinessSignup" />
    <bpmn:sequenceFlow id="SequenceFlow_signup_to_kyc" sourceRef="Task_BusinessSignup" targetRef="Gateway_KYCCheck" />
    <bpmn:sequenceFlow id="SequenceFlow_kyc_approved" name="Approved" sourceRef="Gateway_KYCCheck" targetRef="Task_AccessBusinessPortal">
      <bpmn:conditionExpression>${kyc_approved == true}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_kyc_rejected" name="Rejected" sourceRef="Gateway_KYCCheck" targetRef="EndEvent_ProcessComplete">
      <bpmn:conditionExpression>${kyc_approved == false}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_portal_to_wallet_creation" sourceRef="Task_AccessBusinessPortal" targetRef="Task_CreateCustomerWallet" />
    <bpmn:sequenceFlow id="SequenceFlow_wallet_to_payment_method" sourceRef="Task_CreateCustomerWallet" targetRef="Gateway_PaymentMethod" />
    <bpmn:sequenceFlow id="SequenceFlow_to_qr" name="QR Code" sourceRef="Gateway_PaymentMethod" targetRef="Task_QRPayment">
      <bpmn:conditionExpression>${payment_method == 'QR'}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_to_ussd" name="USSD" sourceRef="Gateway_PaymentMethod" targetRef="Task_USSDPayment">
      <bpmn:conditionExpression>${payment_method == 'USSD'}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_to_eft" name="EFT" sourceRef="Gateway_PaymentMethod" targetRef="Task_EFTPayment">
      <bpmn:conditionExpression>${payment_method == 'EFT'}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_upgrade_no" name="No" sourceRef="Gateway_AccountUpgrade" targetRef="EndEvent_ProcessComplete">
      <bpmn:conditionExpression>${upgrade_account == false}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
  </bpmn:process>
  <bpmn:process id="FNBSystemProcess" isExecutable="true">
    <bpmn:sequenceFlow id="SequenceFlow_wallet_generated" sourceRef="Task_GenerateVirtualWallet" targetRef="Task_ProcessTransaction" />
    <bpmn:serviceTask id="Task_SetupMerchantAccount" name="Setup Merchant Account &#38; API Access" camunda:type="external" camunda:topic="setup_merchant">
      <bpmn:outgoing>SequenceFlow_setup_to_portal</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:serviceTask id="Task_GenerateVirtualWallet" name="Generate Virtual Wallet" camunda:class="com.fnb.phantom.WalletGenerationService">
      <bpmn:outgoing>SequenceFlow_wallet_generated</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:serviceTask id="Task_ProcessTransaction" name="Process Transaction &#38; Update Balance" camunda:class="com.fnb.phantom.TransactionProcessingService">
      <bpmn:incoming>SequenceFlow_qr_to_processing</bpmn:incoming>
      <bpmn:incoming>SequenceFlow_ussd_to_processing</bpmn:incoming>
      <bpmn:incoming>SequenceFlow_eft_to_processing</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_processing_to_upgrade</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:serviceTask id="Task_CreateFullAccount" name="Create Full FNB Account" camunda:class="com.fnb.phantom.AccountCreationService" />
  </bpmn:process>
  <bpmn:process id="CustomerProcess" isExecutable="true">
    <bpmn:userTask id="Task_ReceiveWalletCredentials" name="Receive Wallet Credentials" camunda:assignee="customer">
      <bpmn:incoming>SequenceFlow_wallet_generated</bpmn:incoming>
    </bpmn:userTask>
  </bpmn:process>
  <bpmn:process id="ExternalSystemsProcess" isExecutable="true">
    <bpmn:serviceTask id="Task_MobileMoneyIntegration" name="Mobile Money Integration (Orange, MyZaka)" camunda:type="external" camunda:topic="mobile_money">
      <bpmn:documentation>Integration with external mobile money providers like Orange Money and MyZaka</bpmn:documentation>
    </bpmn:serviceTask>
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_PhantomBanking">
    <bpmndi:BPMNPlane id="BPMNPlane_PhantomBanking" bpmnElement="PhantomBankingCollaboration">
      <bpmndi:BPMNShape id="Participant_FNBSystem" bpmnElement="FNBSystemPool" isHorizontal="true">
        <dc:Bounds x="129" y="440" width="1221" height="200" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_SetupMerchantAccount_di" bpmnElement="Task_SetupMerchantAccount">
        <dc:Bounds x="390" y="500" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_GenerateVirtualWallet_di" bpmnElement="Task_GenerateVirtualWallet">
        <dc:Bounds x="670" y="500" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_ProcessTransaction_di" bpmnElement="Task_ProcessTransaction">
        <dc:Bounds x="1070" y="500" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_CreateFullAccount_di" bpmnElement="Task_CreateFullAccount">
        <dc:Bounds x="1180" y="500" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Participant_Customer" bpmnElement="CustomerPool" isHorizontal="true">
        <dc:Bounds x="129" y="660" width="1221" height="150" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_ReceiveWalletCredentials_di" bpmnElement="Task_ReceiveWalletCredentials">
        <dc:Bounds x="670" y="700" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Participant_ExternalSystems" bpmnElement="ExternalSystemsPool" isHorizontal="true">
        <dc:Bounds x="129" y="830" width="1221" height="150" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_MobileMoneyIntegration_di" bpmnElement="Task_MobileMoneyIntegration">
        <dc:Bounds x="870" y="870" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Participant_BusinessOwner" bpmnElement="BusinessOwnerPool" isHorizontal="true">
        <dc:Bounds x="129" y="80" width="1221" height="320" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_BusinessSignup_di" bpmnElement="Task_BusinessSignup">
        <dc:Bounds x="270" y="190" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_KYCCheck_di" bpmnElement="Gateway_KYCCheck" isMarkerVisible="true">
        <dc:Bounds x="405" y="205" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="390" y="175" width="80" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_AccessBusinessPortal_di" bpmnElement="Task_AccessBusinessPortal">
        <dc:Bounds x="520" y="190" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_CreateCustomerWallet_di" bpmnElement="Task_CreateCustomerWallet">
        <dc:Bounds x="660" y="190" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_PaymentMethod_di" bpmnElement="Gateway_PaymentMethod" isMarkerVisible="true">
        <dc:Bounds x="785" y="205" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="771" y="265" width="78" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_QRPayment_di" bpmnElement="Task_QRPayment">
        <dc:Bounds x="920" y="90" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_USSDPayment_di" bpmnElement="Task_USSDPayment">
        <dc:Bounds x="920" y="190" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_EFTPayment_di" bpmnElement="Task_EFTPayment">
        <dc:Bounds x="920" y="280" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="EndEvent_ProcessComplete_di" bpmnElement="EndEvent_ProcessComplete">
        <dc:Bounds x="1192" y="242" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1165" y="218" width="90" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_AccountUpgrade_di" bpmnElement="Gateway_AccountUpgrade" isMarkerVisible="true">
        <dc:Bounds x="1055" y="235" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1042" y="205" width="76" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="StartEvent_PhantomBanking_di" bpmnElement="StartEvent_PhantomBanking">
        <dc:Bounds x="192" y="212" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="168" y="255" width="84" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_start_to_signup_di" bpmnElement="SequenceFlow_start_to_signup">
        <di:waypoint x="228" y="230" />
        <di:waypoint x="270" y="230" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_signup_to_kyc_di" bpmnElement="SequenceFlow_signup_to_kyc">
        <di:waypoint x="370" y="230" />
        <di:waypoint x="405" y="230" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_kyc_approved_di" bpmnElement="SequenceFlow_kyc_approved">
        <di:waypoint x="455" y="230" />
        <di:waypoint x="520" y="230" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="470" y="212" width="48" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_kyc_rejected_di" bpmnElement="SequenceFlow_kyc_rejected">
        <di:waypoint x="430" y="255" />
        <di:waypoint x="430" y="370" />
        <di:waypoint x="1210" y="370" />
        <di:waypoint x="1210" y="278" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="436" y="332" width="44" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_portal_to_wallet_creation_di" bpmnElement="SequenceFlow_portal_to_wallet_creation">
        <di:waypoint x="620" y="230" />
        <di:waypoint x="660" y="230" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_wallet_to_payment_method_di" bpmnElement="SequenceFlow_wallet_to_payment_method">
        <di:waypoint x="760" y="230" />
        <di:waypoint x="785" y="230" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_to_qr_di" bpmnElement="SequenceFlow_to_qr">
        <di:waypoint x="810" y="205" />
        <di:waypoint x="810" y="130" />
        <di:waypoint x="920" y="130" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="845" y="112" width="46" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_to_ussd_di" bpmnElement="SequenceFlow_to_ussd">
        <di:waypoint x="835" y="230" />
        <di:waypoint x="920" y="230" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="864" y="212" width="31" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_to_eft_di" bpmnElement="SequenceFlow_to_eft">
        <di:waypoint x="810" y="255" />
        <di:waypoint x="810" y="320" />
        <di:waypoint x="920" y="320" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="855" y="302" width="22" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_upgrade_no_di" bpmnElement="SequenceFlow_upgrade_no">
        <di:waypoint x="1105" y="260" />
        <di:waypoint x="1192" y="260" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1132" y="243" width="15" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="MessageFlow_signup_di" bpmnElement="MessageFlow_signup">
        <di:waypoint x="320" y="270" />
        <di:waypoint x="320" y="420" />
        <di:waypoint x="440" y="420" />
        <di:waypoint x="440" y="500" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="MessageFlow_wallet_creation_di" bpmnElement="MessageFlow_wallet_creation">
        <di:waypoint x="710" y="270" />
        <di:waypoint x="710" y="500" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="MessageFlow_wallet_credentials_di" bpmnElement="MessageFlow_wallet_credentials">
        <di:waypoint x="720" y="580" />
        <di:waypoint x="720" y="700" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="MessageFlow_payment_processing_di" bpmnElement="MessageFlow_payment_processing">
        <di:waypoint x="1120" y="580" />
        <di:waypoint x="1120" y="790" />
        <di:waypoint x="920" y="790" />
        <di:waypoint x="920" y="870" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
